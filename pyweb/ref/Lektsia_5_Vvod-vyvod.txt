Санкт-Петербургский государственный университет
телекоммуникаций
им. проф. М. А. Бонч-Бруевича
Кафедра Защищенных систем связи

Разработка защищенного
программного обеспечения

Лекция №5

Ввод-вывод

2

Потоки ввода-вывода
Байтовый

Классы-переходники

Символьный

Ввод

InputStream

InputStreamReader

Reader

Вывод

OutputStream

OutputStreamWriter

Writer

3

Класс IOException
Класс IOException является базовым классом для всех
исключений, связанных с вводом-выводом.
Некоторые подклассы класса IOException:
 EOFException – генерируется, если достигнут конец
файла.
 FileNotFoundException – генерируется в случае, если
файл не найден.
 UnsupportedEncodingException – генерируется, если
требуемая кодировка не поддерживается.
4

Байтовый ввод-вывод
 InputStream – байтовый поток ввода
 OutputStream – байтовый поток вывода

5

Класс InputStream
public abstract int read()

public int read(byte[] b)

Читает следующий байт из потока ввода. Возвращает значение
этого байта в диапазоне от 0 до 255 или -1, если достигнут конец
потока.
Последовательно читает байты из потока ввода и записывает их
в массив b. Может быть прочитано от 0 до (b.length – 1) байт.
Возвращает количество прочитанных байт или -1, если достигнут
конец потока.

public int read(byte[] b, int off, int Последовательно читает от 0 до len байт потока ввода и
len)
записывает их в массив b со смещением off. Возвращает
количество прочитанных байт или -1, если достигнут конец
потока.
public long skip(long n)
Пропускает n байт потока ввода. Возвращает количество
действительно пропущенных байт от 0 до n.
6

public int available()

Возвращает количество байт потока ввода, которые могут
быть прочитаны или пропущены в данный момент.

public void close()

Закрывает поток ввода и освобождает связанные с ним
системные ресурсы.

7

Класс OutputStream
public abstract void
write(int b)

Записывает байт b в поток вывода. Записываются
только младшие 8 бит аргумента b.

public void write(byte[] b) Записывает последовательно все элементы
массива b в поток вывода.
public void write(byte[] b, Записывает len элементов массива b, начиная с
int off, int len)
off, в поток вывода.
public void flush()

Сбрасывает данные на физический носитель.

public void close()

Закрывает поток вывода и освобождает
связанные с ним системные ресурсы.
8

Символьный ввод-вывод
 Reader – символьный поток ввода
 Writer – символьный поток вывода

9

Класс Reader
public int read()

Читает следующий Unicode-символ из потока. Возвращает
значение прочитанного символа в диапазоне от \u0000 до \uFFFF
или -1, если достигнут конец потока.
public int read(CharBuffer Читает символы из потока ввода в буфер класса CharBuffer.
target)
Возвращает количество прочитанных символов или -1, если
достигнут конец потока.
public int read(char[] cbuf) Последовательно читает символы из потока ввода и записывает их
в массив cbuf. Может быть прочитано от 0 до (cbuf.length – 1)
символов. Возвращает количество прочитанных символов или -1,
если достигнут конец потока.
public abstract int
Последовательно читает от 0 до len символов потока ввода и
read(char[] cbuf, int off, int записывает их в массив cbuf со смещением off. Возвращает
len)
количество прочитанных символов или -1, если достигнут конец
потока.
10

public long skip(long n)

Пропускает n символов потока ввода. Возвращает количество
действительно пропущенных символов от 0 до n.

public boolean ready()

Возвращает true, если в данный момент можно прочитать хоть один
символ из потока ввода.

public abstract void close()

Закрывает поток ввода и освобождает связанные с ним системные
ресурсы.

11

Класс Writer
public void write(int c)

Записывает символ c в поток вывода. Записываются
только младшие 16 бит аргумента c.

public void write(char[] cbuf)

Записывает последовательно все элементы массива cbuf
в поток вывода.

public abstract void write(char[]
cbuf, int off,
int len)
public void write(String str)

Записывает len элементов массива cbuf, начиная с off, в
поток вывода.
Записывает строку str в поток вывода.

public void write(String str, int off, int Записывает len символов строки str, начиная с off, в поток
len)
вывода.
public abstract void flush()

Сбрасывает данные на физический носитель.

public abstract void close()

Закрывает поток вывода и освобождает связанные с ним
системные ресурсы.

12

Класс InputStreamReader
InputStreamReader(InputStream in)

Создаёт класс InputStreamReader на основе
байтового потока, используя кодировку по
умолчанию.

InputStreamReader(InputStream in, String
charsetName)

Создаёт класс InputStreamReader на основе
байтового потока. Для преобразования
данных используется кодировка
charsetName.

String getEncoding()

Возвращает кодировку, в соответствие с
которой преобразуются данные.

Пример:
Reader reader = new InputStreamReader(inputStream, "UTF-8");
13

Класс OutputStreamWriter
OutputStreamWriter(Outp Создаёт класс OutputStreamWriter на основе
utStream out)
байтового потока, используя кодировку по
умолчанию.
OutputStreamWriter(Outp Создаёт класс OutputStreamWriter на основе
utStream out, String
байтового потока. Для преобразования данных
charsetName)
используется кодировка charsetName.
String getEncoding()
Возвращает кодировку, в соответствие с которой
преобразуются данные.
Пример:
Writer writer = new OutputStreamWriter(outputStream,
"UTF-8");
14

Буферизованный ввод-вывод
 BufferedReader - буферизует символьный поток ввода,
позволяя вводить символьные данные построчно.
 BufferedWriter - буферизует символьный поток вывода,
позволяя выводить символьные данные построчно.
 PrintStream - предоставляет возможности
форматирования выводимого текста.

15

BufferedReader
BufferedReader(Reader in)

Создаёт буферизованный поток ввода на основе
существующего экземпляра класса Reader. Используется
стандартный размер буфера.

BufferedReader(Reader in, int sz)

Создаёт буферизованный поток ввода на основе
существующего экземпляра класса Reader с заданным
параметром sz размером буфера.

public String readLine()

Читает текст до символа конца строки и записывает его в
объект класса String.

Пример:
BufferedReader in = new BufferedReader(reader);
BufferedReader in = new BufferedReader(
new InputStreamReader(inputStream));
16

BufferedWriter
BufferedWriter(Writer out)

Создаёт буферизованный поток вывода на основе
существующего экземпляра класса Writer. Используется
стандартный размер буфера.

BufferedWriter(Writer out, int sz)

Создаёт буферизованный поток вывода на основе
существующего экземпляра класса Writer с заданным
параметром sz размером буфера.

public void newLine()

Записывает символ конца строки в соответствие с
системными установками.

Пример:
BufferedWriter out = new BufferedWriter(writer);
BufferedWriter out = new BufferedWriter(
new OutputStreamWriter(outputStream));
17

PrintStream
Класс PrintStream предоставляет возможности
форматирования выводимого текста. Он реализует
такие методы, как print, println и printf.

18

Файловый ввод-вывод
Для работы с файлами в Java созданы оболочки над
базовыми классами ввода-вывода.
 FileInputStream – поток байтового ввода из файла.
 FileOutputStream – поток байтового вывода в файл.
 FileReader – поток символьного ввода из файла.
 FileWriter – поток символьного вывода в файл.

19

Копирование бинарного файла
import java.io.*;
public class IOExample {
public static void main(String args[]) {
FileInputStream in = null;
FileOutputStream out = null;
int cnt = 0;
try {
in = new FileInputStream("input.dat");
out = new FileOutputStream("output.dat");
int c;
while ((c = in.read()) != -1) {
out.write(c);
cnt++;
}
out.flush();
} catch(FileNotFoundException e) {
System.err.println("Файл не найден.");
} catch(Exception e) {
System.err.println("Исключение: " +
e.getMessage());

20

} finally {
System.out.println("Скопировано " + cnt +
" байт.");
if (in != null) {
try {
in.close();
} catch(Exception e) {
System.err.println("Исключение: " +
e.getMessage());
}
}
if (out != null) {
try {
out.close();
} catch(Exception e) {
System.err.println("Исключение: " +
e.getMessage());
}
}
}
}
}

21

Обработка текстового файла
import java.io.*;
public class IOExample {
public static void main(String args[]) {
FileReader inputStream = null;
FileWriter outputStream = null;
try {
inputStream = new FileReader("input.txt");
outputStream = new FileWriter("output.txt");
int c;
while ((c = inputStream.read()) != -1) {
outputStream.write(Character.toUpperCase((char)c));
}
} catch(FileNotFoundException e) {
System.err.println("Файл не найден.");
} catch(Exception e) {
System.err.println("Исключение: " +
e.getMessage());

22

} finally {

}

}

}

if (inputStream != null) {
try {
inputStream.close();
} catch(Exception e) {
System.err.println("Исключение: "
+ e.getMessage());
}
}
if (outputStream != null) {
try {
outputStream.close();
} catch(Exception e) {
System.err.println("Исключение: "
+ e.getMessage());
}
}

23

Класс File. Конструкторы
File(File parent, String child)

Создаёт объект File на основе
каталога, заданного объектом File, и
имени файла, заданного строкой.

File(String pathname)

Создаёт объект File на основе пути к
файлу.

File(String parent, String child)

Создаёт объект File на основе
каталога и имени файла, заданного
строками.

24

Класс File. Методы
boolean exists()

Возвращает true, если файл существует.

boolean canRead()

Возвращает true, если файл доступен для чтения.

boolean canWrite()

Возвращает true, если файл доступен для записи.

boolean createNewFile()

Создаёт файл. Возвращает true, если создание
прошло успешно.

boolean mkdir()

Создаёт каталог. Возвращает true, если создание
прошло успешно.

boolean delete()

Удаляет файл или каталог. Возвращает true, если
удаление прошло успешно.
25

boolean renameTo(File dest)

Переименовывает файл или каталог. Возвращает true,
если переименование прошло успешно.

boolean isDirectory()

Возвращает true, если объект File представляет каталог.

boolean isFile()

Возвращает true, если объект File представляет файл.

boolean isHidden()

Возвращает true, если объект File представляет
скрытый файл или каталог.

long lastModified()

Возвращает время последнего изменения файла или
каталога.
Возвращает размер файла.
Возвращает массив объектов File, представляющих
файлы данного каталога.

long length()
File[] listFiles()

26

String[] list()

Возвращает массив имён файлов данного каталога.

String getAbsolutePath()

Возвращает абсолютный путь к файлу.

File getAbsoluteFile()

Возвращает объект File, представляющий
абсолютный путь к файлу.

String getParent()

Возвращает имя каталога, в котором находится
данный файл или каталог.

File getParentFile()

Возвращает объект File, представляющий каталог, в
котором находится данный файл или каталог.

27

Пример работы с файловой системой
import java.io.*;
public class FileExample {
public static void printSubDir(File currentDir) {
System.out.println(currentDir.getAbsolutePath());
if(currentDir.isDirectory()) {
File children[] = currentDir.listFiles();
for(int i = 0; i < children.length; i++)
printSubDir(children[i]);
}
}
public static void main(String args[]) throws IOException {
BufferedReader in = new BufferedReader(
new InputStreamReader(System.in));
System.out.println("Введите имя каталога:");
printSubDir(new File(in.readLine()));
}
}
28

Материалы
• Официальная документация JDK6
http://download.oracle.com/javase/6/docs/api/

29

